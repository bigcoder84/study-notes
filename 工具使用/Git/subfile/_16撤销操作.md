## 撤销操作

#### 一.撤销Git对文件的跟踪

有时候我们需要取消Git对某个文件或文件夹的跟踪，那么我们可以使用下列命令：

```shell
git rm --cached 文件名
```

#### 二.将暂存区恢复成和HEAD指针快照一样（撤销放入暂存区的修改）

​		如果你已经修改了两个文件并且想要将它们作为两次独立的修改提交，但是却意外地输入了 `git add *` 暂存了它们两个，你可以撤销暂存区中其中的某一个文件：

```shell
git reset HEAD <文件名>  #文件名省略时，表示将暂存区所有文件恢复成和HEAD一样
```

#### 三.将工作区的文件恢复成和暂存区一样（撤销工作区的修改）

​	有时候我们修改工作区的某个文件后，如果我们想要回到修改之前（暂存区保存的快照），那么我们使用下面这个命令就能做到：

```shell
git checkout 文件名
git checkout . #丢弃工作空间所有更改
```

#### 四.撤销上一次提交以及上一次提交的提交信息（message）

有时候我们提交过后我们发现还有一个东西未提交，需要将新文件纳入上一次提交中：

我们需要将需要将变更放入暂存区：

```shell
git add -u
```

然后执行：

```shell
git commit --amend #该命令是取消上一次提交，并将上一次提交与这一次提交合并后再重新提交。
```

​	该命令会取消上一次提交，并将暂存区中的文件与上一次提交合并后再提交。

​	 如果我们只是想修改上一次的提交的备注信息（message），那么我们只需要保证暂存区干净，然后使用该命令即可。因为这样能保证没有新的文件更新加入到上次提交中去，我们只需要修改提交信息即可。**

​	如果需要修改历史中某一个commit对象的，就需要用变基操作完成：[变基](_22变基.md)

#### 五.将当前分支指针强制回退到某一次提交

​	需要注意的是：**如果回退到指定位置后，原先的commit对象没有被其它分支所指向，那么这些commit对象就会丢失。**

```shell
git reset --hard <commit的hash值>
```

 选项：

--soft 	完全不触及索引文件或工作树。即，暂存区和工作区都不重置（也就是说在回退之间commit对象所包含的操作，都会显示在“Changes to be commited”中），只是将当前分支指针和HEAD指针进行移动。

--mixed  默认值，重置索引，但不重置工作树。即，重置暂存区信息（也就是说在回退之间commit对象所包含的操作，都会显示在“Changes not staged for commit”或“Untracked files”中），不重置工作区文件（工作区文件与原commit保存一置）。

--hard    重置索引和工作树。自<commit>以来对工作树中跟踪文件的任何更改都将被丢弃。